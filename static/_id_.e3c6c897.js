import{a as E,b as L,c as O,F as q,E as A,d as P,_ as z}from"./entry.0aee9398.js";import{_ as H}from"./nuxt-icon.vue.da6838b7.js";import{_ as J}from"./nuxt-link.8b55c42d.js";import{_ as G}from"./nuxt-layout.debe24ea.js";import{d as Q,a as I,w as W,r as X,$ as Y,C as i,J as h,O as M,R as e,S as V,u as s,H as c,_ as U,ae as F,D as r,M as b,I as g,U as Z,P as y,k as K,af as ee,aa as te,ab as oe}from"./swiper-vue.e1fa97fa.js";import{g as se,u as le}from"./getFetchData.36a52e4f.js";import{p as ae}from"./products.ed55567f.js";async function ne(f){const v=new FormData;v.append("file-to-upload",f[0]);const{apiPath:m}=E().public,k=await se({url:`/api/${m}/admin/upload`,method:"POST",params:v});return k.success?k.imageUrl:(le({icon:"error",title:"檔案上傳失敗",showConfirmButton:!1,timer:3e3}),"")}const d=f=>(te("data-v-903afc9a"),f=f(),oe(),f),ie={class:"h4 fw-bold mb-5"},ce={class:"row mb-3"},re={class:"col-lg-4"},de={class:"mb-3"},ue=d(()=>e("label",{for:"productImg",class:"form-label fw-bold"},"產品圖片",-1)),me=["src","alt"],pe={class:"position-relative mb-3"},_e=d(()=>e("label",{for:"update",class:"form-label position-relative z-1 btn btn-secondary w-100 fs-5"},"上傳圖片",-1)),fe={class:"col"},be={class:"mb-3"},ge=d(()=>e("label",{for:"productTitle",class:"form-label fw-bold"},"產品名稱",-1)),ve={class:"row row-cols-3 mb-3"},he={class:"col"},ye=d(()=>e("label",{for:"description",class:"form-label"},"產品分類",-1)),ke=d(()=>e("option",{value:"",selected:"",disabled:"",hidden:""},"請選擇分類",-1)),we=["value"],Ve={class:"col"},Ue=d(()=>e("label",{for:"description",class:"form-label"},"預計耗時",-1)),Me=["value"],Ce={class:"col"},$e=d(()=>e("label",{for:"price",class:"form-label fw-bold"},"售價",-1)),Se={class:"mb-3"},xe=d(()=>e("p",{class:"form-label fw-bold"},"產品特色",-1)),Ie={class:"col-9 col-lg-10"},Fe={class:"col d-flex align-items-center gap-2 gap-lg-5 fs-4"},Te={class:"mb-3"},De=d(()=>e("p",{class:"form-label fw-bold"},"保存方式",-1)),Ne={class:"d-flex gap-5 mb-3"},Re=["id","checked","value"],Be=["for"],je={class:"col-9 col-lg-10"},Ee={key:0,class:"col d-flex align-items-center gap-2 gap-lg-5 fs-4"},Le={class:"d-flex align-items-center gap-3"},Oe=d(()=>e("p",{class:"fw-bold"},"更多圖片",-1)),qe={class:"position-relative mb-3"},Ae=d(()=>e("label",{for:"updateMore",class:"form-label position-relative z-1 btn btn-outline-secondary px-5"},"上傳圖片",-1)),Pe={class:"row row-cols-2 row-cols-lg-5 g-3"},ze=["onClick"],He=["src","alt"],Je={class:"d-flex justify-content-end gap-3 my-6"},Ge=d(()=>e("button",{type:"submit",class:"btn btn-lg btn-secondary"},"確認",-1)),Qe=Q({__name:"[id]",setup(f){const v=L();console.log(v);const m=I(1),k=I(["使用公版","自定義"]),C=ae(),T={產品名稱:"required",產品圖片:"required",售價:"required|min_value:0|integer",產品特色0:n=>!!n||"產品特色 為必填",保存方式0:n=>!!n||"保存方式 為必填"};W(()=>m.value,n=>{t.saveMethods=n?[""]:["製作完成:需2小時內冷藏。","回家後請冷藏至少2小時,待內餡凝固再食用。","冷藏保存。","請於3天內食用完,口感較佳。"]});const t=X({title:"",category:"",origin_price:0,price:0,unit:"人",description:"",finalTime:1,content:[""],saveMethods:[""],imageUrl:"",imagesUrl:[],is_enabled:1});function $(n){Object.keys(t).includes(n)&&t[n].push("/admin/products")}function S(n,a){Object.keys(t).includes(n)&&t[n].splice(a,1)}async function x(n,a){const p=a.target.files;if(!p)return;const _=await ne(p);typeof t[n]=="string"?t[n]=_:Array.isArray(t[n])&&t[n].push(_)}async function D(){t.price=t.origin_price,t.description=`預計耗時: ${t.finalTime} h`,await C.adminAdd(t),console.log("送出表單",t),O().push()}return(n,a)=>{const p=q,_=A,w=H,N=J,R=P,B=G,j=Y("number");return i(),h(B,{name:"back"},{default:M(()=>[e("h1",ie,V(Number(s(v).params)?"修改品項":"新增品項"),1),c(R,{onSubmit:D,"validation-schema":T},{default:M(()=>[e("div",ce,[e("div",re,[e("div",de,[ue,c(p,{class:"form-control",id:"productImg",name:"產品圖片",type:"text",placeholder:"請輸入圖片網址",modelValue:s(t).imageUrl,"onUpdate:modelValue":a[0]||(a[0]=o=>s(t).imageUrl=o)},null,8,["modelValue"]),c(_,{name:"產品圖片",class:"text-danger"})]),e("img",{src:s(t).imageUrl,alt:s(t).title,class:"imageUrl mb-3"},null,8,me),e("div",pe,[_e,e("input",{class:"form-control position-absolute opacity-0 top-0 start-0",type:"file",id:"update",onChange:a[1]||(a[1]=o=>x("imageUrl",o))},null,32)])]),e("div",fe,[e("div",be,[ge,c(p,{class:"form-control",id:"productTitle",name:"產品名稱",type:"text",placeholder:"請輸入產品名稱",modelValue:s(t).title,"onUpdate:modelValue":a[2]||(a[2]=o=>s(t).title=o)},null,8,["modelValue"]),c(_,{name:"產品名稱",class:"text-danger"})]),e("div",ve,[e("div",he,[ye,U(e("select",{id:"description",class:"form-select","onUpdate:modelValue":a[3]||(a[3]=o=>s(t).category=o)},[ke,(i(!0),r(g,null,b(s(C).categoryList,o=>(i(),r("option",{key:o,value:o},V(o),9,we))),128))],512),[[F,s(t).category]])]),e("div",Ve,[Ue,U(e("select",{id:"description",class:"form-select","onUpdate:modelValue":a[4]||(a[4]=o=>s(t).finalTime=o)},[(i(),r(g,null,b([1,1.5,2,2.5,3],o=>e("option",{key:o,value:o},V(o)+" 小時 ",9,Me)),64))],512),[[F,s(t).finalTime]])]),e("div",Ce,[$e,U(c(p,{class:"form-control",id:"price",name:"售價",type:"text",placeholder:"請輸入售價",modelValue:s(t).origin_price,"onUpdate:modelValue":a[5]||(a[5]=o=>s(t).origin_price=o),modelModifiers:{number:!0}},null,8,["modelValue"]),[[j]]),c(_,{name:"售價",class:"text-danger"})])]),e("div",Se,[xe,e("ul",null,[(i(!0),r(g,null,b(s(t).content,(o,l)=>(i(),r("li",{class:"row align-items-center",key:l},[e("div",Ie,[c(p,{class:"form-control mb-2",name:`產品特色${l}`,type:"text",modelValue:s(t).content[l],"onUpdate:modelValue":u=>s(t).content[l]=u},null,8,["name","modelValue","onUpdate:modelValue"])]),e("div",Fe,[l<4&&l===s(t).content.length-1?(i(),h(w,{key:0,name:"add",class:"pointer",onClick:a[6]||(a[6]=u=>$("content"))})):y("",!0),l!==0?(i(),h(w,{key:1,name:"delete",class:"pointer",onClick:u=>S("content",l)},null,8,["onClick"])):y("",!0)])]))),128))]),c(_,{name:"產品特色0",class:"text-danger"})]),e("div",Te,[De,e("div",Ne,[(i(!0),r(g,null,b(s(k),(o,l)=>(i(),r("div",{class:"form-check",key:o},[U(e("input",{class:"form-check-input",type:"radio",name:"saveMethods",id:`mode${l}`,checked:s(m)===l,value:l,"onUpdate:modelValue":a[7]||(a[7]=u=>K(m)?m.value=u:null)},null,8,Re),[[ee,s(m)]]),e("label",{class:"form-check-label fw-bold pointer",for:`mode${l}`},V(o),9,Be)]))),128))]),e("ul",null,[(i(!0),r(g,null,b(s(t).saveMethods,(o,l)=>(i(),r("li",{class:"row align-items-center",key:l},[e("div",je,[c(p,{class:"form-control mb-2",name:`保存方式${l}`,type:"text",modelValue:s(t).saveMethods[l],"onUpdate:modelValue":u=>s(t).saveMethods[l]=u,readonly:!s(m)},null,8,["name","modelValue","onUpdate:modelValue","readonly"])]),s(m)?(i(),r("div",Ee,[l<4&&l===s(t).saveMethods.length-1?(i(),h(w,{key:0,name:"add",class:"pointer",onClick:a[8]||(a[8]=u=>$("saveMethods"))})):y("",!0),l!==0?(i(),h(w,{key:1,name:"delete",class:"pointer",onClick:u=>S("saveMethods",l)},null,8,["onClick"])):y("",!0)])):y("",!0)]))),128))]),c(_,{name:"保存方式0",class:"text-danger"})])])]),e("div",Le,[Oe,e("div",qe,[Ae,e("input",{class:"form-control position-absolute opacity-0 top-0 start-0",type:"file",name:"",id:"updateMore",onChange:a[9]||(a[9]=o=>x("imagesUrl",o))},null,32)])]),e("div",Pe,[(i(!0),r(g,null,b(s(t).imagesUrl,(o,l)=>(i(),r("div",{class:"col position-relative",key:l},[e("button",{type:"button",class:"btn btn-close position-absolute top-5 end-5 bg-white p-2 rounded-circle",onClick:u=>s(t).imagesUrl.splice(l,1)},null,8,ze),e("img",{src:o,alt:o,class:"object-fit-cover w-100",height:"150"},null,8,He)]))),128))]),e("div",Je,[c(N,{to:"/admin/products",class:"btn btn-lg btn-primary"},{default:M(()=>[Z(" 取消 ")]),_:1}),Ge])]),_:1})]),_:1})}}});const ot=z(Qe,[["__scopeId","data-v-903afc9a"]]);export{ot as default};
